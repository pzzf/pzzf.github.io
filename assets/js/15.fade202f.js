(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{518:function(s,a,n){"use strict";n.r(a);var t=n(12),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("p",[s._v("ftp入门。")]),s._v(" "),n("h2",{attrs:{id:"ftp安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ftp安装"}},[s._v("#")]),s._v(" ftp安装")]),s._v(" "),n("div",{staticClass:"language-angular2 line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("#安装\nyum install -y vsftpd\n\n#设置开机启动\nsystemctl enable vsftpd.service\n\n#启动\nsystemctl start vsftpd.service\n\n#停止\nsystemctl stop vsftpd.service\n\n#查看状态\nsystemctl status vsftpd.service\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])]),n("h2",{attrs:{id:"ftp配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ftp配置"}},[s._v("#")]),s._v(" ftp配置")]),s._v(" "),n("div",{staticClass:"language-angular2 line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("#打开配置文件\nvim /etc/vsftpd/vsftpd.conf\n\n#显示行号\n:set number\n\n#修改配置 12 行\nanonymous_enable=NO\n\n#修改配置 33 行\nanon_mkdir_write_enable=YES\n\n#修改配置48行\nchown_uploads=YES\n\n#修改配置72行\nasync_abor_enable=YES\n\n#修改配置82行\nascii_upload_enable=YES\n\n#修改配置83行\nascii_download_enable=YES\n\n#修改配置86行\nftpd_banner=Welcome to blah FTP service.\n\n#修改配置100行\nchroot_local_user=YES\n\n#添加下列内容到vsftpd.conf末尾\nuse_localtime=YES\nlisten_port=21\nidle_session_timeout=300\nguest_enable=YES\nguest_username=vsftpd\nuser_config_dir=/etc/vsftpd/vconf\ndata_connection_timeout=1\nvirtual_use_local_privs=YES\npasv_min_port=40000\npasv_max_port=40010\naccept_timeout=5\nconnect_timeout=1\nallow_writeable_chroot=YES\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br")])]),n("h2",{attrs:{id:"建立用户文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#建立用户文件"}},[s._v("#")]),s._v(" 建立用户文件")]),s._v(" "),n("div",{staticClass:"language-angular2 line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("#创建编辑用户文件\nvim /etc/vsftpd/virtusers\n#第一行为用户名，第二行为密码。不能使用root作为用户名 \n\nrollboy\n12345\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h2",{attrs:{id:"生成用户数据文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#生成用户数据文件"}},[s._v("#")]),s._v(" 生成用户数据文件")]),s._v(" "),n("div",{staticClass:"language-angular2 line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("db_load -T -t hash -f /etc/vsftpd/virtusers /etc/vsftpd/virtusers.db\n\n#设定PAM验证文件，并指定对虚拟用户数据库文件进行读取\n\nchmod 600 /etc/vsftpd/virtusers.db \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h2",{attrs:{id:"修改-etc-pam-d-vsftpd-文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#修改-etc-pam-d-vsftpd-文件"}},[s._v("#")]),s._v(" 修改 /etc/pam.d/vsftpd 文件")]),s._v(" "),n("div",{staticClass:"language-angular2 line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# 修改前先备份 \n\ncp /etc/pam.d/vsftpd /etc/pam.d/vsftpd.bak\n\nvi /etc/pam.d/vsftpd\n#先将配置文件中原有的 auth 及 account 的所有配置行均注释掉\nauth sufficient /lib64/security/pam_userdb.so db=/etc/vsftpd/virtusers \naccount sufficient /lib64/security/pam_userdb.so db=/etc/vsftpd/virtusers \n\n# 如果系统为32位，上面改为lib\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("h2",{attrs:{id:"新建系统用户vsftpd，用户目录为-home-vsftpd"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#新建系统用户vsftpd，用户目录为-home-vsftpd"}},[s._v("#")]),s._v(" 新建系统用户vsftpd，用户目录为/home/vsftpd")]),s._v(" "),n("div",{staticClass:"language-angular2 line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("#用户登录终端设为/bin/false(即：使之不能登录系统)\nuseradd vsftpd -d /home/vsftpd -s /bin/false\nchown -R vsftpd:vsftpd /home/vsftpd\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h2",{attrs:{id:"建立虚拟用户个人配置文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#建立虚拟用户个人配置文件"}},[s._v("#")]),s._v(" 建立虚拟用户个人配置文件")]),s._v(" "),n("div",{staticClass:"language-angular2 line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("mkdir /etc/vsftpd/vconf\ncd /etc/vsftpd/vconf\n\n#这里建立虚拟用户leo配置文件\ntouch leo\n\n#编辑leo用户配置文件，内容如下，其他用户类似\nvi leo\n\nlocal_root=/home/vsftpd/leo/\nwrite_enable=YES\nanon_world_readable_only=NO\nanon_upload_enable=YES\nanon_mkdir_write_enable=YES\nanon_other_write_enable=YES\n\n#建立leo用户根目录\nmkdir -p /home/vsftpd/leo/\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br")])]),n("h2",{attrs:{id:"防火墙设置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#防火墙设置"}},[s._v("#")]),s._v(" 防火墙设置")]),s._v(" "),n("div",{staticClass:"language-angular2 line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("IPtables 的设置方式：\nvi /etc/sysconfig/iptables\n#编辑iptables文件，添加如下内容，开启21端口\n-A INPUT -m state --state NEW -m tcp -p tcp --dport 21 -j ACCEPT\n-A INPUT -m state --state NEW -m tcp -p tcp --dport 40000:40010 -j ACCEPT\n\n\nfirewall 的设置方式：\nfirewall-cmd --zone=public --add-service=ftp --permanent\n\nfirewall-cmd --zone=public --add-port=21/tcp --permanent\nfirewall-cmd --zone=public --add-port=40000-40010/tcp --permanent \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("h2",{attrs:{id:"重启vsftpd服务器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#重启vsftpd服务器"}},[s._v("#")]),s._v(" 重启vsftpd服务器")]),s._v(" "),n("div",{staticClass:"language-linux line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("systemctl restart vsftpd.service\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h2",{attrs:{id:"使用ftp工具连接测试"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#使用ftp工具连接测试"}},[s._v("#")]),s._v(" 使用ftp工具连接测试")]),s._v(" "),n("p",[s._v("这个时候，使用ftp的工具连接时，我们发现是可以连接的。传输文件的时候，会发现文件上传和下载都会出现")]),s._v(" "),n("p",[s._v("500、503 、200等问题。这个时候，可以进行以下操作：")]),s._v(" "),n("h3",{attrs:{id:"方式一、关闭selinux"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#方式一、关闭selinux"}},[s._v("#")]),s._v(" 方式一、关闭SELINUX")]),s._v(" "),n("div",{staticClass:"language-angular2 line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("#打开SELINUX配置文件\nvim /etc/selinux/config\n#修改配置参数\n#注释  \nSELINUX=enforcing\n#增加  \nSELINUX=disabled  \n\n#修改完成后，需要重启！\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h3",{attrs:{id:"方式二、selinux不对vsftp不做任何限制"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#方式二、selinux不对vsftp不做任何限制"}},[s._v("#")]),s._v(" 方式二、SELINUX不对vsftp不做任何限制")]),s._v(" "),n("div",{staticClass:"language-angular2 line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("\nsetsebool -P ftpd_connect_all_unreserved 1\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("如果还是有问题尝试给我们用户的ftp目录，设置一下操作权限")]),s._v(" "),n("div",{staticClass:"language-angular2 line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("chmod -R 775 /home/vsftpd/leo\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);